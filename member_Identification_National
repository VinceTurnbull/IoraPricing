select distinct member_ssn
from (
         select member_ssn, mailling_address_state, pcp_id, row_number() OVER (partition by member_ssn) as rank
         from analytics_dw.member
         where grouper_id in ('02188100'
, '02188101'
, '02188102'
, '02188103'
, '02188104'
, '02188105'
, '03822001'
, '03822004'
, '03822007'
, '03822010'
, '03822011'
, '03822013'
, '03822016'
, '20956000'
, '20956001'
, '20956002'
, '20956004'
, '20956005'
, '20956006'
, '20956007'
, '20969000'
, '20969001'
, '20969002'
, '20969004'
, '20969005'
, '20969006'
, '20969007'
, '30213110'
, '33298008'
, '33298009'
, '33298010'
, '33298011'
, '33298012'
, '80382624'
, '80382625'
, '80382635'
, '80382636'
, '80382638'
, '80382641'
, '80382642'
, '80382644'
, '80382646'
, '80382647'
, '80382648'
, '80382649'
, '80382662'
, '80382663'
, '80382664'
, '80650082'
, '80650083'
, '80650084'
, '80650085'
, '80650086'
, '80650514'
, '84750087'
, '84750088'
, '84750093'
, '84750094'
, '84750175'
, '84750176'
, '84760000'
, '84760001'))

where rank = 1 
and member_ssn is not null
